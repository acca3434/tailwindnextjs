### 개요

Next.js 13버전을 좀 더 명확히 사용해야 한다면, 복습을 해야겠다.

1. **서버사이드 렌더링 (SSR):**

    - SSR은 초기 페이지 요청 시 서버에서 데이터를 가져와 HTML로 렌더링한 다음 클라이언트에 전달하는 방식입니다.
    - 이로써 초기 로딩 속도가 빠르고, 검색 엔진 최적화 (SEO)에 유리합니다.
    - 그러나 상호작용적인 요소를 사용하기 어려우며, 서버에서 실행되므로 브라우저 API (예: 로컬 스토리지)에 접근할 수 없습니다.

2. **클라이언트 렌더링 (CSR):**

    - CSR은 페이지를 로드한 후 클라이언트 측에서 JavaScript를 사용하여 동적으로 페이지를 생성하는 방식입니다.
    - 페이지의 내용을 상호작용적으로 업데이트할 수 있으며, 브라우저 API에 접근할 수 있습니다.
    - 그러나 초기 로딩 속도가 느리며, SEO에 미치는 영향이 있을 수 있습니다.

Next.js 13 버전에서 도입된 'use client' 지시어는 컴포넌트 클라이언트 개념을 도입한 것입니다. 이를 이해하기 위에는 서버사이드 렌더링 (SSR)과 클라이언트 렌더링 (CSR)의 차이를 이해해야 하기 때문에, 설명했습니다.

## use client 지시어

'use client' 지시어는 Next.js 13 버전 이후 도입된 기능으로, 클라이언트에서 렌더링되는 React 컴포넌트를 정의하고 경계를 설정하기 위한 것입니다. 이를 이해하기 위해 서버사이드 렌더링 (SSR)과 클라이언트 렌더링 (CSR)의 차이를 설명하며, 'use client'를 사용하여 동적 상호작용 요소를 가진 컴포넌트를 만드는 예시를 제공하였습니다.

### 예시

가령, 웹 애플리케이션에 댓글 시스템을 구현한다고 가정해봅시다. 사용자는 웹 페이지에서 댓글을 작성하고 다른 사용자의 댓글을 볼 수 있어야 합니다. 또한, 댓글 작성자는 작성한 댓글을 수정하거나 삭제할 수 있어야 합니다. 이때, 댓글 작성, 수정, 삭제와 같은 동적 상호작용을 다루려면 'use client'를 사용하는 컴포넌트가 필요합니다.

다음은 'use client'를 사용하여 구현된 예시 코드입니다. 이 코드는 댓글 작성과 댓글 목록을 클라이언트에서 렌더링하는 부분을 보여줍니다.

```javascript
// CommentForm.js
'use client';

import React, { useState } from 'react';

export default function CommentForm() {
  const [comment, setComment] = useState('');

  const handleSubmit = () => {
    // 클라이언트에서 댓글 작성 동작
    // API 호출 등의 작업을 수행하고
    // 댓글을 목록에 추가
  };

  return (
    <div>
      <textarea
        value={comment}
        onChange={(e) => setComment(e.target.value)}
        placeholder="댓글을 작성하세요"
      />
      <button onClick={handleSubmit}>댓글 작성</button>
    </div>
  );
}

// CommentList.js
import React from 'react';

export default function CommentList({ comments }) {
  return (
    <ul>
      {comments.map((comment) => (
        <li key={comment.id}>
          {comment.text}
          <button>수정</button>
          <button>삭제</button>
        </li>
      ))}
    </ul>
  );
}
```

위 코드에서 `CommentForm` 컴포넌트는 댓글을 작성할 때 사용하며, 사용자는 텍스트를 입력하고 "댓글 작성" 버튼을 클릭하여 댓글을 작성할 수 있습니다. 이 동작은 클라이언트에서 처리됩니다.

또한, `CommentList` 컴포넌트는 댓글 목록을 표시하고 각 댓글에 대한 수정 및 삭제 버튼을 표시합니다. 사용자가 수정 또는 삭제 버튼을 클릭했을 때 해당 동작도 클라이언트에서 처리됩니다.

이렇게 'use client'를 사용하면 댓글 시스템과 같은 동적 상호작용 요소를 구현하고, 사용자 경험을 향상시킬 수 있습니다. 이러한 요소는 초기 로딩이 느릴 수 있지만, 사용자는 웹 페이지가 로드된 후에 동적인 동작을 수행할 수 있게 됩니다.

다시 설명하자면, `use client`는 Next.js 13 버전 이후에 도입된 기능으로, 클라이언트에서 렌더링되는 React 컴포넌트를 정의하고 경계를 설정하기 위한 것입니다. 이것은 기본적으로 서버사이드 렌더링(SSR)과 클라이언트사이드 렌더링(CSR)의 경계를 정의하는 데 사용됩니다. 즉, 파일에 "use client"를 정의하면 하위 구성 요소를 포함하여 해당 파일로 가져온 다른 모든 모듈이 클라이언트 번들의 일부로 간주됩니다.

그리고 "번들"은 JavaScript 코드와 그에 따른 의존성 파일의 모음입니다. 번들은 웹 애플리케이션의 코드를 단일 파일 또는 파일 그룹으로 묶어서 클라이언트에 제공하는 데 사용됩니다. 번들링을 통해 모든 JavaScript 코드 및 리소스를 효율적으로 전달할 수 있으며, 클라이언트에서 애플리케이션을 실행할 때 필요한 모든 코드를 사용할 수 있게 됩니다.

"useState" 등의 React 훅은 클라이언트 측에서 UI 상태를 관리하거나 상호 작용을 처리하는 데 사용됩니다. 서버사이드 렌더링 (SSR)에서는 서버에서 초기 렌더링을 통해 UI를 생성할 수 있지만, 클라이언트 측에서 발생하는 상호 작용 및 상태 관리를 위해서는 "useState"와 같은 클라이언트 측 기능이 필요합니다.

## 서버 컴포넌트에서 훅을 사용할 수 없는 이유에 대한 부가설명

서버 사이드 컴포넌트 (Server Components)는 초기 페이지 렌더링을 서버에서 수행하는 기술로, 서버에서 클라이언트에 HTML을 전달합니다. 이는 초기 로딩 속도와 SEO 최적화에 큰 장점을 제공합니다.

그러나 서버에서 렌더링된 컴포넌트는 브라우저에서 실행되지 않습니다. 즉, 서버에서 HTML로 렌더링된 컴포넌트는 클라이언트에서 정적이며 비대화형입니다. 클라이언트에서 이 컴포넌트가 동작하도록 하려면 해당 컴포넌트를 클라이언트 컴포넌트로 선언하고 경계를 정의해야 합니다. 이것이 'use client' 지시어의 역할입니다.

서버 사이드 컴포넌트에서는 서버와 클라이언트 간의 데이터 동기화를 처리하기 위한 다양한 복잡성을 다루고 있습니다. 서버 컴포넌트가 클라이언트에서 실행되지 않기 때문에, 서버 컴포넌트에서 useState와 같은 클라이언트 사이드의 상태 및 동작을 다루는 것은 의미가 없습니다.

따라서 서버 사이드 컴포넌트에서 상태 및 동작을 다루려면 서버 사이드 상태(Server State)를 활용하거나, 클라이언트 사이드에 있는 컴포넌트에서 해당 로직을 수행하는 것이 일반적인 패턴입니다. 'use client' 지시어를 사용하면 특정 컴포넌트를 클라이언트에서 렌더링하여 클라이언트 사이드 렌더링 및 상호 작용을 가능하게 하기 위한 것입니다.

아래는 `use client`를 사용한 예제 코드의 설명입니다:

```jsx
// 클라이언트 구성 요소를 정의합니다.
'use client'
import { useState } from 'react'

export default function Counter() {
    const [count, setCount] = useState(0)

    return (
        <div>
            <p>You clicked {count} times</p>
            <button onClick={() => setCount(count + 1)}>Click me</button>
        </div>
    )
}
```

-   `use client`를 사용하여 해당 파일은 클라이언트 번들에 포함됩니다.
-   이 컴포넌트는 클라이언트에서 렌더링되며, 클라이언트 측에서 클릭 이벤트를 처리하고 `useState`를 사용하여 상태를 관리합니다.
-   서버사이드 렌더링 시 초기 렌더링은 서버에서 수행됩니다.
-   이후 클라이언트에서 이 컴포넌트를 다운로드하고, 상호 작용 및 상태 변경을 처리합니다.

즉, `use client`를 사용하면 해당 컴포넌트가 클라이언트에서 렌더링되도록 하며, 클라이언트 측에서 React 훅과 같은 클라이언트 측 라이브러리를 활용할 수 있게 합니다. 이것은 상호작용성이 필요한 UI 구성 요소를 더 효과적으로 다루는 데 도움이 됩니다.

> 출처

-   [Next.js에서의 클라이언트 컴포넌트](https://nextjs.org/docs/app/building-your-application/rendering/client-components)
